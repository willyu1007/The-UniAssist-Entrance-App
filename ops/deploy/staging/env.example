# =========================
# Shared baseline
# =========================
NODE_ENV=staging

# Persistence
DATABASE_URL=postgresql://<user>:<password>@<host>:5432/uniassist_staging
REDIS_URL=redis://<host>:6379

# Streams
UNIASSIST_STREAM_PREFIX=uniassist:timeline:
UNIASSIST_STREAM_GLOBAL_KEY=uniassist:timeline:all
UNIASSIST_STREAM_GROUP=ua-delivery-staging
UNIASSIST_STREAM_CONSUMER=ua-worker-staging

# Security
UNIASSIST_ADAPTER_SECRET=<replace-with-strong-secret>
UNIASSIST_PROVIDER_CONTEXT_TOKEN=<replace-with-provider-token>

# Provider integration
UNIASSIST_PLAN_PROVIDER_BASE_URL=https://provider-plan.staging.example.com

# =========================
# Worker tuning
# =========================
OUTBOX_POLL_MS=1000
OUTBOX_BATCH_SIZE=100
OUTBOX_MAX_ATTEMPTS=12
OUTBOX_BACKOFF_BASE_MS=1000
OUTBOX_BACKOFF_MAX_MS=300000
STREAM_CONSUMER_BLOCK_MS=2000
STREAM_CONSUMER_BATCH_SIZE=100

# =========================
# Post-deploy verification
# =========================
STAGING_GATEWAY_BASE_URL=https://gateway.staging.example.com
STAGING_PROVIDER_PLAN_BASE_URL=https://provider-plan.staging.example.com
STAGING_ADAPTER_WECHAT_BASE_URL=https://adapter-wechat.staging.example.com
STAGING_CONTEXT_TOKEN=<same-as-UNIASSIST_PROVIDER_CONTEXT_TOKEN-or-readonly-token>
STAGING_VERIFY_TIMEOUT_MS=30000

# =========================
# Worker reliability drill
# =========================
WORKER_DRILL_MODE=simulate
WORKER_DRILL_TIMEOUT_MS=45000
WORKER_DRILL_ENABLE_NOGROUP=true
WORKER_DRILL_OUTPUT_PATH=ops/deploy/reports/staging-worker-drill-latest.md
